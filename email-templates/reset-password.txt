import { type } from "arktype"
import { Button, Section, Hr, Text, Heading } from "@react-email/components"
import { Subject, NotificationCategory, Props} from "@stackframe/emails"

export const variablesSchema = type({
  passwordResetLink: "string"
})

export function EmailTemplate({ user, project, variables }: Props<typeof variablesSchema.infer>) {
  return (
    <>
      <Subject value={`Reset your UtilitySheet password`} />
      <NotificationCategory value="Transactional" />
      
      {/* Lock Icon */}
      <div className="text-center py-4">
        <div className="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-[#475569] to-[#64748b] rounded-full">
          <span className="text-white text-2xl">üîê</span>
        </div>
      </div>

      {/* Main Heading */}
      <Heading className="text-[#1e293b] text-2xl font-bold text-center m-0 pb-2" style={{ fontFamily: "'Figtree', sans-serif" }}>
        Reset Your Password
      </Heading>
      
      {/* Greeting */}
      <Text className="text-[#64748b] text-base text-center m-0 pb-6" style={{ fontFamily: "'Figtree', sans-serif" }}>
        Hi{user.displayName ? ` ${user.displayName}` : ''}! We received a request to reset your password.
      </Text>

      {/* Description */}
      <Text className="text-[#475569] text-base text-center m-0 pb-6" style={{ fontFamily: "'Figtree', sans-serif" }}>
        Click the button below to create a new password for your UtilitySheet account.
      </Text>

      {/* CTA Button */}
      <div className="text-center py-4">
        <Button
          href={variables.passwordResetLink}
          target="_blank"
          className="inline-block bg-[#475569] text-white font-semibold text-base py-4 px-8 rounded-lg no-underline"
          style={{ fontFamily: "'Figtree', sans-serif" }}
        >
          Reset My Password
        </Button>
      </div>

      {/* Time Warning */}
      <Text className="text-[#94a3b8] text-sm text-center m-0 py-4" style={{ fontFamily: "'Figtree', sans-serif" }}>
        This link expires in 1 hour for security reasons.
      </Text>

      {/* Alternative Link */}
      <Text className="text-[#94a3b8] text-sm text-center m-0" style={{ fontFamily: "'Figtree', sans-serif" }}>
        Or copy and paste this link into your browser:
      </Text>
      <Text className="text-[#64748b] text-xs text-center break-all m-0 pb-6 px-4" style={{ fontFamily: "'Figtree', sans-serif", wordBreak: 'break-all' }}>
        {variables.passwordResetLink}
      </Text>

      {/* Divider */}
      <Hr className="border-[#e2e8f0] my-6" />

      {/* Security Note */}
      <Text className="text-[#94a3b8] text-xs text-center m-0" style={{ fontFamily: "'Figtree', sans-serif" }}>
        If you didn't request a password reset, please ignore this email or contact support if you have concerns.
      </Text>
    </>
  )
}

EmailTemplate.PreviewVariables = {
  passwordResetLink: "https://utilitysheet.com/reset-password?token=example"
} satisfies typeof variablesSchema.infer